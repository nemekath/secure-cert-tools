{% extends "modern_layout.html" %}

{% block title %}Security & Features - Secure Cert-Tools{% endblock %}

{% block content %}
<div class="hero hero--compact">
    <div class="hero__content">
        <h1 class="hero__title">
            <svg class="hero__icon" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                <path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4z"/>
            </svg>
            Security & Features
        </h1>
        <p class="hero__subtitle">
            Understanding our security design and powerful features
        </p>
    </div>
</div>

<div class="content-sections">
    <!-- Security Design Principles -->
    <section class="card">
        <div class="card__header">
            <h2 class="card__title">üîí Security Design Principles</h2>
            <p class="card__subtitle">How we protect your private keys and data</p>
        </div>
        
        <div class="security-grid">
            <div class="security-item">
                <div class="security-icon">üö´</div>
                <h3>Zero Storage Policy</h3>
                <p><strong>Private keys and certificates are NEVER stored</strong> on our servers. All cryptographic operations happen in memory during your browser session only.</p>
            </div>
            
            <div class="security-item">
                <div class="security-icon">‚ö°</div>
                <h3>Browser-Session Only</h3>
                <p>All processing occurs during your active session. When you close your browser or navigate away, all data is permanently destroyed.</p>
            </div>
            
            <div class="security-item">
                <div class="security-icon">üîê</div>
                <h3>End-to-End HTTPS</h3>
                <p>All data transmission uses TLS 1.3 with perfect forward secrecy. Your keys are encrypted during transit and never logged.</p>
            </div>
            
            <div class="security-item">
                <div class="security-icon">üõ°Ô∏è</div>
                <h3>Modern Cryptography</h3>
                <p>Only secure algorithms: RSA 2048/4096-bit and ECDSA P-256/P-384/P-521. No deprecated or weak cryptography.</p>
            </div>
        </div>
    </section>
    
    <!-- Current Features -->
    <section class="card">
        <div class="card__header">
            <h2 class="card__title">üöÄ Current Features</h2>
            <p class="card__subtitle">Comprehensive certificate management tools</p>
        </div>
        
        <div class="features-list">
            <div class="feature-category">
                <h3>üìù CSR Generation</h3>
                <ul>
                    <li><strong>RSA Keys:</strong> 2048-bit (recommended) and 4096-bit (high security)</li>
                    <li><strong>ECDSA Keys:</strong> P-256, P-384, and P-521 curves</li>
                    <li><strong>RFC Compliance:</strong> Full RFC 5280 and RFC 6125 validation</li>
                    <li><strong>Private Networks:</strong> Support for .local, .corp, single-label domains, and IP addresses</li>
                    <li><strong>Subject Alternative Names:</strong> Multi-domain and wildcard certificate support</li>
                </ul>
            </div>
            
            <div class="feature-category">
                <h3>üîç Verification Tools</h3>
                <ul>
                    <li><strong>CSR ‚Üî Private Key Matching:</strong> Cryptographically verify CSR and private key pairs</li>
                    <li><strong>Certificate ‚Üî Private Key Matching:</strong> Verify CA-signed certificates with private keys</li>
                    <li><strong>Encrypted Private Key Support:</strong> Handle OpenSSL encrypted private keys with passphrases</li>
                    <li><strong>Multiple Key Formats:</strong> PKCS#8, traditional RSA/EC, and encrypted formats</li>
                </ul>
            </div>
            
            <div class="feature-category">
                <h3>üìä CSR Analysis</h3>
                <ul>
                    <li><strong>RFC Compliance Checking:</strong> Detailed analysis against RFC standards</li>
                    <li><strong>Security Assessment:</strong> Key strength and algorithm validation</li>
                    <li><strong>Extension Analysis:</strong> Subject Alternative Names and other extensions</li>
                    <li><strong>Private Domain Detection:</strong> Identify domains suitable only for private CAs</li>
                </ul>
            </div>
        </div>
    </section>
    
    <!-- Addressing Common Concerns -->
    <section class="card">
        <div class="card__header">
            <h2 class="card__title">‚ùì Addressing Common Concerns</h2>
            <p class="card__subtitle">Transparent answers to security questions</p>
        </div>
        
        <div class="faq-list">
            <div class="faq-item">
                <h3>"Can you see my private keys?"</h3>
                <p><strong>No.</strong> Private keys are generated in memory and immediately returned to your browser. They are never written to disk, logged, or stored in any database. Our code is open source for verification.</p>
            </div>
            
            <div class="faq-item">
                <h3>"Is this safer than generating keys locally?"</h3>
                <p>Local generation is always most secure. However, our web-based tool offers convenience with strong security measures. We recommend local generation for production systems and our tool for development, testing, or when OpenSSL isn't available.</p>
            </div>
            
            <div class="faq-item">
                <h3>"What about network interception?"</h3>
                <p>All communication uses HTTPS with TLS 1.3 and perfect forward secrecy. Even if network traffic were intercepted, the encryption keys are ephemeral and cannot decrypt past sessions.</p>
            </div>
            
            <div class="faq-item">
                <h3>"Can I verify your claims?"</h3>
                <p><strong>Yes!</strong> Our source code is publicly available on GitHub. You can review our security implementation, run the tool locally, or deploy your own instance.</p>
            </div>
            
            <div class="faq-item">
                <h3>"What data do you collect?"</h3>
                <p>We collect minimal technical logs (IP addresses, timestamps, request types) for security monitoring. No cryptographic material, form data, or personal information is logged or stored.</p>
            </div>
        </div>
    </section>
    
    <!-- Alternative: Local Generation -->
    <section class="card">
        <div class="card__header">
            <h2 class="card__title">üíª Local Generation Alternative</h2>
            <p class="card__subtitle">Generate CSRs locally with OpenSSL</p>
        </div>
        
        <div class="local-generation">
            <p>For maximum security, generate your CSR locally on a trusted computer:</p>
            
            <div class="code-examples">
                <div class="code-example">
                    <h4>RSA 2048-bit (Recommended)</h4>
                    <pre><code>openssl req -new -newkey rsa:2048 -nodes -keyout example.key -out example.csr -sha256</code></pre>
                </div>
                
                <div class="code-example">
                    <h4>RSA 4096-bit (High Security)</h4>
                    <pre><code>openssl req -new -newkey rsa:4096 -nodes -keyout example.key -out example.csr -sha256</code></pre>
                </div>
                
                <div class="code-example">
                    <h4>ECDSA P-256 (Modern)</h4>
                    <pre><code>openssl ecparam -genkey -name prime256v1 -noout -out example.key
openssl req -new -key example.key -out example.csr -sha256</code></pre>
                </div>
                
                <div class="code-example">
                    <h4>With Encrypted Private Key</h4>
                    <pre><code>openssl req -new -newkey rsa:2048 -keyout example.key -out example.csr -sha256</code></pre>
                    <p class="code-note">Removes <code>-nodes</code> to encrypt the private key with a passphrase</p>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Security Headers & Technical Details -->
    <section class="card">
        <div class="card__header">
            <h2 class="card__title">üîß Technical Security Measures</h2>
            <p class="card__subtitle">Additional protections implemented</p>
        </div>
        
        <div class="technical-details">
            <div class="tech-category">
                <h3>HTTP Security Headers</h3>
                <ul>
                    <li><code>Strict-Transport-Security</code> - Force HTTPS connections</li>
                    <li><code>X-Content-Type-Options: nosniff</code> - Prevent MIME confusion</li>
                    <li><code>X-Frame-Options: DENY</code> - Prevent clickjacking</li>
                    <li><code>X-XSS-Protection</code> - Enable XSS filtering</li>
                    <li><code>Referrer-Policy</code> - Control referrer information</li>
                </ul>
            </div>
            
            <div class="tech-category">
                <h3>Input Validation</h3>
                <ul>
                    <li>RFC-compliant domain validation</li>
                    <li>Cryptographic parameter validation</li>
                    <li>File format and size restrictions</li>
                    <li>XSS and injection prevention</li>
                </ul>
            </div>
            
            <div class="tech-category">
                <h3>Modern Standards</h3>
                <ul>
                    <li>SHA-256 signatures (SHA-1 deprecated)</li>
                    <li>Minimum 2048-bit RSA keys</li>
                    <li>NIST-recommended ECDSA curves</li>
                    <li>RFC 5280 and RFC 6125 compliance</li>
                </ul>
            </div>
        </div>
    </section>
</div>

<style>
.hero--compact {
    padding: 3rem 0;
}

.content-sections {
    display: flex;
    flex-direction: column;
    gap: 2rem;
    max-width: 900px;
    margin: 0 auto;
}

.security-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem;
    margin-top: 1.5rem;
}

.security-item {
    padding: 1.5rem;
    border: 1px solid var(--border-color);
    border-radius: 8px;
    text-align: center;
}

.security-icon {
    font-size: 2rem;
    margin-bottom: 1rem;
}

.security-item h3 {
    margin: 0 0 0.5rem 0;
    color: var(--text-primary);
}

.features-list, .faq-list {
    margin-top: 1.5rem;
}

.feature-category, .faq-item {
    margin-bottom: 2rem;
}

.feature-category h3, .faq-item h3 {
    color: var(--text-primary);
    margin-bottom: 0.75rem;
}

.feature-category ul {
    margin: 0;
    padding-left: 1.5rem;
}

.feature-category li {
    margin-bottom: 0.5rem;
    line-height: 1.5;
}

.faq-item {
    padding: 1.5rem;
    border: 1px solid var(--border-color);
    border-radius: 8px;
}

.faq-item h3 {
    margin-top: 0;
    color: var(--primary-color);
}

.code-examples {
    margin-top: 1.5rem;
}

.code-example {
    margin-bottom: 1.5rem;
}

.code-example h4 {
    margin: 0 0 0.5rem 0;
    color: var(--text-primary);
}

.code-example pre {
    background: var(--bg-secondary);
    padding: 1rem;
    border-radius: 4px;
    overflow-x: auto;
    margin: 0.5rem 0;
}

.code-example code {
    font-family: 'Courier New', monospace;
    font-size: 0.9rem;
}

.code-note {
    font-size: 0.9rem;
    color: var(--text-secondary);
    font-style: italic;
    margin: 0.5rem 0 0 0;
}

.technical-details {
    margin-top: 1.5rem;
}

.tech-category {
    margin-bottom: 2rem;
}

.tech-category h3 {
    color: var(--text-primary);
    margin-bottom: 0.75rem;
}

.tech-category ul {
    margin: 0;
    padding-left: 1.5rem;
}

.tech-category li {
    margin-bottom: 0.5rem;
    line-height: 1.5;
}

.tech-category code {
    background: var(--bg-secondary);
    padding: 0.2rem 0.4rem;
    border-radius: 3px;
    font-size: 0.9rem;
}

@media (max-width: 768px) {
    .security-grid {
        grid-template-columns: 1fr;
    }
}
</style>
{% endblock %}
